<div class="min-h-screen bg-gray-50">
  <!-- Main Content -->
  <div class="flex flex-col min-h-screen">
    <!-- Header -->
    <header class="bg-white flex items-center justify-between px-6 py-6 border-b border-gray-200 shadow-sm">
      <div class="flex-1">
        <h1 class="text-2xl font-bold text-gray-900 mb-1">
          {{ getUserGreeting() }}
        </h1>
        <p class="text-lg text-gray-600">¬øQu√© puedes hacer hoy?</p>
      </div>
      <div class="flex items-center space-x-4">
        <!-- Points Display -->
        <div class="bg-blue-50 px-4 py-2 rounded-full border border-blue-200">
          <span class="text-blue-800 font-semibold">üèÜ {{ totalPoints }} puntos</span>
        </div>
        <!-- Profile Button -->
        <button 
          class="p-2 hover:bg-gray-100 rounded-full transition-colors flex items-center justify-center"
          (click)="navigateTo('/profile')"
          [attr.aria-label]="'Ir al perfil de ' + (currentUser?.username || 'usuario')"
        >
          <div class="w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center overflow-hidden">
            <img 
              *ngIf="getProfileImageUrl()" 
              [src]="getProfileImageUrl()" 
              [alt]="'Foto de perfil de ' + (currentUser?.username || 'usuario')"
              class="w-full h-full object-cover"
            >
            <span *ngIf="!getProfileImageUrl()" class="text-xl">üë§</span>
          </div>
        </button>
      </div>
    </header>

    <!-- Main Content -->
    <main class="flex-1 px-6 py-6 pb-24">
      <!-- User Role Badge -->
      <div class="mb-6 flex items-center justify-between">
        <div class="bg-green-50 px-3 py-1 rounded-full border border-green-200">
          <span class="text-green-800 text-sm font-medium">{{ getUserRole() }}</span>
        </div>
        <button 
          class="text-blue-600 text-sm font-medium hover:text-blue-800"
          (click)="toggleCalendarView()"
        >
          {{ showCalendarView ? 'Ver lista' : 'Ver calendario' }}
        </button>
      </div>

      <!-- Today's Activities Section -->
      <div class="mb-8">
        <h2 class="text-xl font-bold text-gray-900 mb-4">Para hoy</h2>
        
        <!-- Today's Activities - Joined -->
        <div *ngIf="todayActivities.length > 0" class="mb-6">
          <h3 class="text-lg font-semibold text-gray-800 mb-3">Actividades en las que participas</h3>
          <div class="space-y-3">
            <div *ngFor="let activity of todayActivities" 
                 class="bg-green-50 border border-green-200 rounded-lg p-4 hover:bg-green-100 cursor-pointer transition-colors"
                 (click)="navigateTo('/activities/' + activity.id)">
              <div class="flex items-center space-x-3">
                <span class="text-2xl">{{ getActivityEmoji(activity.title) }}</span>
                <div class="flex-1">
                  <h4 class="font-semibold text-gray-900">{{ activity.title }}</h4>
                  <p class="text-sm text-gray-600">{{ formatActivityDate(activity.date) }}</p>
                  <p class="text-sm text-gray-600" *ngIf="activity.location">üìç {{ activity.location }}</p>
                </div>
                <span class="text-green-600 font-medium">¬°Confirmado!</span>
              </div>
            </div>
          </div>
        </div>

        <!-- Available Activities -->
        <div *ngIf="availableActivities.length > 0" class="mb-6">
          <h3 class="text-lg font-semibold text-gray-800 mb-3">Actividades disponibles</h3>
          <div class="space-y-3">
            <div *ngFor="let activity of availableActivities.slice(0, 3)" 
                 class="bg-blue-50 border border-blue-200 rounded-lg p-4 hover:bg-blue-100 cursor-pointer transition-colors"
                 (click)="navigateTo('/activities/' + activity.id)">
              <div class="flex items-center space-x-3">
                <span class="text-2xl">{{ getActivityEmoji(activity.title) }}</span>
                <div class="flex-1">
                  <h4 class="font-semibold text-gray-900">{{ activity.title }}</h4>
                  <p class="text-sm text-gray-600">{{ formatActivityDate(activity.date) }}</p>
                  <p class="text-sm text-gray-600" *ngIf="activity.location">üìç {{ activity.location }}</p>
                </div>
                <span class="text-blue-600 font-medium">¬°√önete!</span>
              </div>
            </div>
          </div>
        </div>

        <!-- No Activities Today -->
        <div *ngIf="todayActivities.length === 0 && availableActivities.length === 0" 
             class="text-center py-8 bg-gray-50 rounded-lg border border-gray-200">
          <div class="text-4xl mb-3">üìÖ</div>
          <p class="text-gray-600 text-lg mb-2">No hay actividades para hoy</p>
          <p class="text-gray-500 text-sm mb-4">¬°Pero puedes ver las pr√≥ximas actividades!</p>
          <button 
            class="px-6 py-2 bg-blue-500 text-white rounded-full font-semibold hover:bg-blue-600 transition-colors"
            (click)="navigateTo('/activities')"
          >
            Ver todas las actividades
          </button>
        </div>
      </div>

      <!-- Weekly Calendar or List View -->
      <div class="mb-8">
        <h2 class="text-xl font-bold text-gray-900 mb-4">Esta semana</h2>
        
        <!-- Calendar View -->
        <div *ngIf="showCalendarView" class="bg-white rounded-lg border border-gray-200 p-4">
          <div class="grid grid-cols-7 gap-1 mb-2">
            <div *ngFor="let day of weekDays" 
                 class="text-center p-3 rounded-lg transition-colors"
                 [class]="day.isToday ? 'bg-blue-100 border border-blue-300' : 'hover:bg-gray-50'">
              <div class="text-sm font-semibold text-gray-700 mb-1">{{ day.dayName }}</div>
              <div class="text-lg font-bold" 
                   [class]="day.isToday ? 'text-blue-600' : 'text-gray-900'">
                {{ day.dayNumber }}
              </div>
              <div *ngIf="day.activities.length > 0" class="mt-1">
                <div class="w-2 h-2 bg-green-500 rounded-full mx-auto"></div>
                <div class="text-xs text-gray-600 mt-1">{{ day.activities.length }}</div>
              </div>
            </div>
          </div>
        </div>

        <!-- List View -->
        <div *ngIf="!showCalendarView" class="space-y-3">
          <div *ngFor="let activity of upcomingActivities.slice(0, 5)" 
               class="bg-white rounded-lg border border-gray-200 p-4 hover:bg-gray-50 cursor-pointer transition-colors"
               (click)="navigateTo('/activities/' + activity.id)">
            <div class="flex items-center space-x-3">
              <span class="text-2xl">{{ getActivityEmoji(activity.title) }}</span>
              <div class="flex-1">
                <h4 class="font-semibold text-gray-900">{{ activity.title }}</h4>
                <p class="text-sm text-gray-600">{{ formatActivityDate(activity.date) }}</p>
                <p class="text-sm text-gray-600" *ngIf="activity.location">üìç {{ activity.location }}</p>
              </div>
              <span class="text-gray-400">‚Üí</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Groups Section -->
      <div *ngIf="userGroups.length > 0" class="mb-8">
        <h2 class="text-xl font-bold text-gray-900 mb-4">Tus grupos</h2>
        <div class="space-y-3">
          <div *ngFor="let group of userGroups.slice(0, 3)" 
               class="bg-white rounded-lg border border-gray-200 p-4 hover:bg-gray-50 cursor-pointer transition-colors"
               (click)="navigateTo('/groups/' + group.id)">
            <div class="flex items-center space-x-3">
              <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center">
                <span class="text-2xl">üë•</span>
              </div>
              <div class="flex-1">
                <h4 class="font-semibold text-gray-900">{{ group.name }}</h4>
                <p class="text-sm text-gray-600">{{ group.member_count }} miembros</p>
              </div>
              <span class="text-gray-400">‚Üí</span>
            </div>
          </div>
        </div>
      </div>

    </main>

    <!-- Bottom Navigation -->
    <app-bottom-nav></app-bottom-nav>
  </div>
</div>